<!-- Connection -->

<div class="page-header"><h1 data-i18n="phonegap.connection.title">phonegap.connection.title</h1></div>

<p><span data-i18n="phonegap.connection.label">phonegap.connection.label</span>: <span id="connectionType" style="font-weight: bold" data-i18n="phonegap.loader">Please, wait...</span></p>


<!-- Acceleration -->

<div class="page-header"><h1 data-i18n="phonegap.acceleration.title">phonegap.acceleration.title</h1></div>

<p>
    <a id="btnAccelerationStart" class="btn btn-primary btn-large" href="#" data-i18n="phonegap.acceleration.start">phonegap.acceleration.start</a>
    <a id="btnAccelerationStop" class="btn btn-info btn-large" href="#" data-i18n="phonegap.acceleration.stop" style="display: none">phonegap.acceleration.stop</a>
</p>

<p><span id="accelerationText"></span></p>


<!-- Compass -->

<div class="page-header"><h1>Compass</h1></div>

<p>
    <a id="btnCompassStart" class="btn btn-primary btn-large" href="#" data-i18n="phonegap.acceleration.start">phonegap.acceleration.start</a>
    <a id="btnCompassStop" class="btn btn-info btn-large" href="#" data-i18n="phonegap.acceleration.stop" style="display: none">phonegap.acceleration.stop</a>
</p>

<p><span id="compassText"></span></p>


<!-- Bottom description and code -->

<div data-i18n="phonegap.description">phonegap.description</div>

<script type="text/javascript">
/*<![CDATA[*/
    function checkConnection()
    {
        var networkState = ((navigator.connection) ? navigator.connection.type : ((navigator.network && navigator.network.connection) ? navigator.network.connection.type : 'unknown'));

        var states = {};
        states[Connection.UNKNOWN]  = 'Unknown connection';
        states[Connection.ETHERNET] = 'Ethernet connection';
        states[Connection.WIFI]     = 'WiFi connection';
        states[Connection.CELL_2G]  = 'Cell 2G connection';
        states[Connection.CELL_3G]  = 'Cell 3G connection';
        states[Connection.CELL_4G]  = 'Cell 4G connection';
        states[Connection.CELL]     = 'Cell generic connection';
        states[Connection.NONE]     = 'No network connection';

        $('#connectionType').html(states[networkState]);
    }

    /**
     * Acceleration
     */

    function onAccelerationSuccess(acceleration)
    {
        var g = 9.80665;
        
        acceleration.x = (acceleration.x * g).toFixed(2) + ' m/s\u00b2';
        acceleration.y = (acceleration.y * g).toFixed(2) + ' m/s\u00b2';
        acceleration.z = ((acceleration.z + 1) * g).toFixed(2) + ' m/s\u00b2';
        
        var timestampText = i18n.t('phonegap.acceleration.line2', {timestamp: acceleration.timestamp});

        var accelerationText = i18n.t('phonegap.acceleration.line1',
        {
            axis: 'X',
            acceleration: acceleration.x
        });

        accelerationText = accelerationText + '<br />' + i18n.t('phonegap.acceleration.line1',
        {
            axis: 'Y',
            acceleration: acceleration.y
        });

        accelerationText = accelerationText + '<br />' + i18n.t('phonegap.acceleration.line1',
        {
            axis: 'Z',
            acceleration: acceleration.z
        });

        $('#accelerationText').html(accelerationText + '<br />' + timestampText);
    }
    
    function onAccelerationError()
    {
        $('#accelerationText').html(i18n.t('phonegap.acceleration.error'));
    };
    
    /**
     * Compass
     */

    function onCompassSuccess(compass)
    {
        var
            timestampText = 'Current timestamp is <strong>' + compass.timestamp + '</strong>.',
            headingText = '<strong>Magnetic heading</strong> is <strong>' + compass.magneticHeading + '</strong>.<br />';
    
        headingText = headingText + '<strong>True heading</strong> is <strong>' + compass.trueHeading + '</strong>.<br />';
        headingText = headingText + '<strong>Heading accuracy</strong> is <strong>' + compass.headingAccuracy + '</strong>.';

        $('#compassText').html(headingText + '<br />' + timestampText);
    }
    
    function onCompassError(CompassError)
    {
        if(CompassError.COMPASS_INTERNAL_ERR) $('#compassText').html('Internal compass error has occured!');
        
        if(CompassError.COMPASS_NOT_SUPPORTED) $('#compassText').html('Compass is not supported on this device!');
    };
    
    /**
     * jQuery
     */
    
	$(function($)
    {
        /**
         * Variables
         */
        var
            compassID = 0,
            accelerationID = 0;
            
        /**
         * Acceleration
         */
		$('#btnAccelerationStart').click(function()
		{
            //Fake initial values
            var
                acceleration = new Object(),
                now = new Date();
            
            acceleration.x = 0;
            acceleration.y = 0;
            acceleration.z = -1;
            acceleration.timestamp = now.getTime();
            
            onAccelerationSuccess(acceleration);
            
            //Start watching...
			accelerationID = navigator.accelerometer.watchAcceleration(onAccelerationSuccess, onAccelerationError, {frequency: 100});
			
			$('#btnAccelerationStop').show();
			$('#btnAccelerationStart').hide();
		});

		$('#btnAccelerationStop').click(function()
		{
			navigator.accelerometer.clearWatch(accelerationID);
            
            $('#accelerationText').html('');
			
			$('#btnAccelerationStart').show();
			$('#btnAccelerationStop').hide();
		});
        
        /**
         * Compass
         */
		$('#btnCompassStart').click(function()
		{
            //Fake initial values
            var
                compass = new Object(),
                now = new Date();
            
            compass.magneticHeading = 0;
            compass.trueHeading = 0;
            compass.headingAccuracy = 0;
            compass.timestamp = now.getTime();
            
            onCompassSuccess(compass);
            
            //Start watching...
			compassID = navigator.compass.watchHeading(onCompassSuccess, onCompassError);
			
			$('#btnCompassStop').show();
			$('#btnCompassStart').hide();
		});

		$('#btnCompassStop').click(function()
		{
			navigator.compass.clearWatch(compassID);
            
            $('#compassText').html('');
			
			$('#btnCompassStart').show();
			$('#btnCompassStop').hide();
		});
    });
/*]]>*/
</script>